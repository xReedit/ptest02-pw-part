<div class="pending-orders-container">
    <div class="app-header">
        <button class="back-btn" (click)="goBack()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
        </button>
        <div class="header-title">
            <h2>Pedidos Disponibles</h2>
            <span class="subtitle">Selecciona un pedido para entregarlo</span>
        </div>
    </div>

    <div class="content">
        @if (isLoading()) {
        <div class="loading-state">
            <div class="spinner"></div>
            <p>Buscando pedidos cercanos...</p>
        </div>
        } @else if (pendingOrders().length === 0) {
        <div class="empty-state">
            <div class="empty-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
            </div>
            <h3>¡Todo al día!</h3>
            <p>No hay pedidos pendientes en este momento.</p>
            <button class="btn-refresh" (click)="loadOrders()">Actualizar ahora</button>
        </div>
        } @else {
        <div class="orders-list">
            @for (order of pendingOrders(); track order.idpedido) {
            <div class="order-card compact shadow-premium" @orderAnimation>
                <div class="card-left">
                    <div class="order-id"><span class="hash">#</span>{{ order.idpedido }}</div>
                    <div class="client-name">{{ getClientName(order) }}</div>
                    <div class="address-text">{{ getAddress(order) }}</div>
                    <div class="meta-row">
                        <span class="payment-badge" [ngClass]="getPaymentClass(order)">
                            {{ getPaymentMethod(order) }}
                        </span>
                        <span class="order-time">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            {{ getElapsedTime(order) }}
                        </span>
                    </div>
                </div>

                <div class="card-right">
                    <div class="amount">S/ {{ order.total_r || order.total }}</div>
                    <button class="btn-accept-compact" (click)="assignOrder(order)" [disabled]="isAssigning()">
                        @if (isAssigning() && currentAssigningId() === order.idpedido) {
                        <span class="spinner-mini"></span>
                        } @else {
                        <span>ASIGNARSE</span>
                        }
                    </button>
                </div>
            </div>
            }
        </div>
        }
    </div>
</div>